<!-- PAGE HEADER -->
<div class="page-header">
  <div class="page-label">Add New Spot</div>
  <h1 class="page-title">Share Your Hidden Corner</h1>
  <p class="page-description">
    Do you have a peaceful place you discovered? Share it with our community and 
    help others discover it too.
  </p>
</div>

<!-- FORM CONTAINER -->
<div class="form-container">
  <div class="form-layout">
    
    <!-- MAIN FORM -->
    <div class="form-section">
      <h2 class="form-section-title">Spot Information</h2>
      
      <!-- Spot Name -->
      <div class="form-group">
        <label class="form-label form-label-required">Spot Name</label>
        <input 
          type="text" 
          class="form-input"
          [class.error]="errors().name"
          placeholder="E.g. Ã‡ankaya Castle Hill"
          [ngModel]="formData().name"
          (ngModelChange)="updateField('name', $event)">
        @if (errors().name) {
          <div class="form-error">{{ errors().name }}</div>
        } @else {
          <div class="form-hint">An explanatory name for your spot</div>
        }
      </div>

      <!-- Category -->
      <div class="form-group">
        <label class="form-label form-label-required">Category</label>
        <select 
          class="form-select"
          [class.error]="errors().type"
          [ngModel]="formData().type"
          (ngModelChange)="updateField('type', $event)">
          <option [value]="null">Select a category</option>
          @for (type of spotTypes; track type.value) {
            <option [value]="type.value">{{ type.emoji }} {{ type.label }}</option>
          }
        </select>
        @if (errors().type) {
          <div class="form-error">{{ errors().type }}</div>
        }
      </div>

      <!-- Address -->
      <div class="form-group">
        <label class="form-label form-label-required">Address</label>
        <input 
          type="text" 
          class="form-input"
          [class.error]="errors().address"
          placeholder="E.g. Ã‡ankaya, Ankara"
          [ngModel]="formData().address"
          (ngModelChange)="updateField('address', $event)">
        @if (errors().address) {
          <div class="form-error">{{ errors().address }}</div>
        } @else {
          <div class="form-hint">General location of your spot</div>
        }
      </div>

      <!-- Description -->
      <div class="form-group">
        <label class="form-label form-label-required">Description</label>
        <textarea 
          class="form-textarea"
          [class.error]="errors().description"
          placeholder="Provide detailed information about your spot. What makes it special? When is it most beautiful?"
          [ngModel]="formData().description"
          (ngModelChange)="updateField('description', $event)"></textarea>
        @if (errors().description) {
          <div class="form-error">{{ errors().description }}</div>
        } @else {
          <div class="form-hint">At least 50 characters</div>
        }
      </div>

      <!-- Map Location Picker -->
      <div class="map-picker">
        <label class="form-label form-label-required">Location</label>
        <div class="form-hint" style="margin-bottom: 10px;">Click on the map to set the location</div>
        <div class="map-container">
          <div id="location-map"></div>
        </div>
        <div class="coordinates-display">
          <div class="coordinate-item">
            <strong>Lat:</strong> <span>{{ formData().latitude.toFixed(6) }}</span>
          </div>
          <div class="coordinate-item">
            <strong>Lng:</strong> <span>{{ formData().longitude.toFixed(6) }}</span>
          </div>
        </div>
      </div>

      <!-- Image Upload -->
      <div class="image-upload">
        <label class="form-label">Image</label>
        
        @if (!imagePreview()) {
          <div class="upload-area" (click)="fileInput.click()">
            <div class="upload-icon">ðŸ“·</div>
            <div class="upload-text">Click to upload an image</div>
            <div class="upload-hint">PNG, JPG - Maks 5MB</div>
          </div>
        } @else {
          <div class="image-preview">
            <img [src]="imagePreview()" alt="Preview">
            <button class="image-remove" (click)="removeImage()">Ã—</button>
          </div>
        }
        
        <input 
          #fileInput
          type="file" 
          accept="image/*" 
          style="display: none;"
          (change)="onFileSelected($event)">
      </div>

      <!-- Best Time -->
      <div class="form-group">
        <label class="form-label">Best Time</label>
        <input 
          type="text" 
          class="form-input" 
          placeholder="E.g. Evening 17:00-19:00"
          [ngModel]="formData().bestTime"
          (ngModelChange)="updateField('bestTime', $event)">
        <div class="form-hint">Best time to visit your spot (e.g. Morning, Evening)</div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button 
          class="btn-submit" 
          [disabled]="isSubmitting()"
          (click)="onSubmit()">
          @if (isSubmitting()) {
            Adding...
          } @else {
            Add Spot
          }
        </button>
        <button 
          class="btn-cancel"
          [disabled]="isSubmitting()"
          (click)="onCancel()">
          Cancel
        </button>
      </div>
    </div>

    <!-- SIDEBAR PREVIEW -->
    <div class="sidebar-preview">
      <div class="preview-card">
        <div class="preview-header">
          <h3>Preview</h3>
        </div>
        
        @if (imagePreview()) {
          <div class="preview-image" [style.background]="'none'">
            <img [src]="imagePreview()" alt="Preview" style="width: 100%; height: 100%; object-fit: cover;">
          </div>
        } @else {
          <div class="preview-image"></div>
        }
        
        <div class="preview-content">
          <h4 class="preview-title">{{ previewTitle() }}</h4>
          <p class="preview-address">{{ previewAddress() }}</p>
          <p class="preview-description">{{ previewDescription() }}</p>
          
          <div class="preview-meta">
            <div class="preview-meta-item">
              <div class="preview-meta-label">Category</div>
              <div class="preview-meta-value">{{ previewCategory() }}</div>
            </div>
            <div class="preview-meta-item">
              <div class="preview-meta-label">Time</div>
              <div class="preview-meta-value">{{ previewTime() }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>