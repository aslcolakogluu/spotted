<!-- PAGE HEADER -->
<div class="page-header">
  <h1>Explore <em>Spots</em></h1>
  <p>City's hidden, quiet and scenic corners. Filter, sort and discover.</p>
</div>

<!-- FILTER SECTION (Sticky) -->
<div class="filter-section">
  <div class="filter-controls">
    <!-- Search Bar - ‚úÖ Enter ile arama -->
    <div class="search-bar">
      <input type="text" [(ngModel)]="searchQuery" (keyup.enter)="onSearchSubmit()" placeholder="Search Spot...">

      @if (searchQuery){
      <button class="search-clear" (click)="clearSearch()">√ó</button>
      }

    </div>

    <!-- Category Chips -->
    <div class="filter-chips">
      <button class="filter-chip" (click)="setCategory(null)" [class.active]="selectedCategory() === null">
        All
      </button>

      @for (item of spotTypes; track item.value) {
      <button class="filter-chip" (click)="setCategory(item.value)" [class.active]="selectedCategory() === item.value">
        <span class="chip-icon" [innerHTML]="item.icon"></span> {{ item.label }}
      </button>
      }
    </div>

    <!-- Sort Dropdown -->
    <div class="sort-dropdown">
      <select [ngModel]="sortBy()" (ngModelChange)="sortBy.set($event); onSortChange()">
        <option value="rating">Highest Rated</option>
        <option value="most_reviewed">Most Reviewed</option>
        <option value="newest">Newest</option>
      </select>
    </div>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="main-content">
  <!-- LEFT SIDEBAR -->
  <aside class="sidebar">
    <!-- Rating Filter -->
    <div class="sidebar-section">
      <h3>Puan</h3>
      <div class="rating-filter">
        <div class="rating-option">
          <input type="checkbox" id="5star" [(ngModel)]="filter5Star" (change)="applyFilters()" />
          <label for="5star"> <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span> 5 Stars </label>
        </div>

        <div class="rating-option">
          <input type="checkbox" id="4star" [(ngModel)]="filter4Star" (change)="applyFilters()" />
          <label for="4star"> <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ</span> 4+ Stars </label>
        </div>

        <div class="rating-option">
          <input type="checkbox" id="3star" [(ngModel)]="filter3Star" (change)="applyFilters()" />
          <label for="3star"> <span class="stars">‚òÖ‚òÖ‚òÖ</span> 3+ Stars </label>
        </div>
      </div>
    </div>

    <!-- Weekly Rankings -->
    <div class="rankings">
      <h4>üèÜ This Week's Most Visited</h4>

      @for (item of topRankings; track item.id; let i = $index) {
      <div class="ranking-item">
        <div class="ranking-number" [class.top1]="i === 0" [class.top2]="i === 1" [class.top3]="i === 2"
          [class.other]="i > 2">
          {{ i + 1 }}
        </div>

        <div class="ranking-info">
          <h5>{{ item.name }}</h5>
          <p>‚òÖ {{ item.rating }} ¬∑ {{ item.reviewCount }} reviews</p>
        </div>
      </div>
      }
    </div>
  </aside>

  <!-- RIGHT: Results Grid -->
  <div>
    <!-- Results Count - ‚úÖ Parantez yok -->
    <div class="results-header">
      <div class="results-count">
        <strong>{{ filteredSpots.length }}</strong> spots found
      </div>
    </div>

    <!-- Spot Grid - ‚úÖ Parantez yok -->
    <div class="spot-grid">
      @for (spot of paginatedSpots; track spot.id; let i = $index) {
      <a class="spot-card">
        <!-- Card Image -->
        <div class="card-img">
          @if (spot.imageUrl) {
          <img [src]="spot.imageUrl" [alt]="spot.name" class="card-real-img" />
          <div class="card-img-overlay"></div>
          } @else {
          <div class="card-img-bg" [style.background]="getGradient(i)"></div>
          <div class="card-img-overlay"></div>
          }

          <span class="card-img-tag">
            <span class="tag-icon" [innerHTML]="getSpotTypeIcon(spot.type)"></span> {{ getSpotTypeLabel(spot.type) }}
          </span>
        </div>

        <!-- Card Body -->
        <div class="card-body">
          <h4>{{ spot.name }}</h4>
          <p class="card-location">{{ spot.address }}</p>

          <div class="card-footer">
            <span class="card-rating">
              <span class="card-stars">{{ getStars(spot.rating) }}</span> {{
              spot.rating }}
            </span>
            <span class="card-hour">{{ spot.reviewCount }} reviews</span>
          </div>
        </div>
      </a>
      }
    </div>

    <!-- Pagination - ‚úÖ Parantez yok -->
    @if (totalPages > 1) {
    <div class="pagination">
      <button (click)="prevPage()" [disabled]="currentPage() === 1">
        ‚Üê Previous
      </button>

      @for (p of visiblePages; track p) { @if (p === -1) {
      <button disabled>...</button>
      } @else {
      <button (click)="goToPage(p)" [class.active]="p === currentPage()">
        {{ p }}
      </button>
      } }

      <button (click)="nextPage()" [disabled]="currentPage() === totalPages">
        Next ‚Üí
      </button>
    </div>
    }
  </div>
</div>